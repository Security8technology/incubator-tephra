<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Wed Sep 05 00:00:33 PDT 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>HBaseTransactionPruningPlugin (Apache Tephra 0.15.0-incubating API)</title>
<meta name="date" content="2018-09-05">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="HBaseTransactionPruningPlugin (Apache Tephra 0.15.0-incubating API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HBaseTransactionPruningPlugin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/tephra/hbase/txprune/DataJanitorState.TableSupplier.html" title="interface in org.apache.tephra.hbase.txprune"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/tephra/hbase/txprune/InvalidListPruningDebugTool.html" title="class in org.apache.tephra.hbase.txprune"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html" target="_top">Frames</a></li>
<li><a href="HBaseTransactionPruningPlugin.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.tephra.hbase.txprune</div>
<h2 title="Class HBaseTransactionPruningPlugin" class="title">Class HBaseTransactionPruningPlugin</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.tephra.hbase.txprune.HBaseTransactionPruningPlugin</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html" title="interface in org.apache.tephra.txprune">TransactionPruningPlugin</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">HBaseTransactionPruningPlugin</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html" title="interface in org.apache.tephra.txprune">TransactionPruningPlugin</a></pre>
<div class="block">Default implementation of the <a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html" title="interface in org.apache.tephra.txprune"><code>TransactionPruningPlugin</code></a> for HBase.

 This plugin determines the prune upper bound for transactional HBase tables that use
 coprocessor <a href="../../../../../org/apache/tephra/hbase/coprocessor/TransactionProcessor.html" title="class in org.apache.tephra.hbase.coprocessor"><code>TransactionProcessor</code></a>.

 <h3>State storage:</h3>

 This plugin expects the TransactionProcessor to save the prune upper bound for invalid transactions
 after every major compaction of a region. Let's call this <i>(region, prune upper bound)</i>.
 In addition, the plugin also persists the following information on a run at time <i>t</i>
 <ul>
   <li>
     <i>(t, set of regions)</i>: Set of transactional regions at time <i>t</i>.
     Transactional regions are regions of the tables that have the coprocessor TransactionProcessor
     attached to them.
   </li>
   <li>
     <i>(t, inactive transaction bound)</i>: This is the smallest not in-progress transaction that
     will not have writes in any HBase regions that are created after time <i>t</i>.
     This value is determined by the Transaction Service based on the transaction state at time <i>t</i>
     and passed on to the plugin.
   </li>
 </ul>

 <h3>Computing prune upper bound:</h3>

 In a typical HBase instance, there can be a constant change in the number of regions due to region creations,
 splits and merges. At any given time there can always be a region on which a major compaction has not been run.
 Since the prune upper bound will get recorded for a region only after a major compaction,
 using only the latest set of regions we may not be able to find the
 prune upper bounds for all the current regions. Hence we persist the set of regions that exist at that time
 of each run of the plugin, and use historical region set for time <i>t</i>, <i>t - 1</i>, etc.
 to determine the prune upper bound.

 From the regions saved at time <i>t</i>, <i>t - 1</i>, etc.,
 the plugin tries to find the latest <i>(t, set of regions)</i> where all regions have been major compacted,
 i.e, all regions have prune upper bound recorded in <i>(region, prune upper bound)</i>.
 <br/>
 If such a set is found for time <i>t1</i>, the prune upper bound returned by the plugin is the minimum of
 <ul>
   <li>Prune upper bounds of regions in set <i>(t1, set of regions)</i></li>
   <li>Inactive transaction bound from <i>(t1, inactive transaction bound)</i></li>
 </ul>

 <p/>
 Above, when we find <i>(t1, set of regions)</i>, there may a region that was created after time <i>t1</i>,
 but has a data write from an invalid transaction that is smaller than the prune upper bounds of all
 regions in <i>(t1, set of regions)</i>. This is possible because <i>(region, prune upper bound)</i> persisted by
 TransactionProcessor is always the latest prune upper bound for a region.
 <br/>
 However a region created after time <i>t1</i> cannot have writes from an invalid transaction that is smaller than
 inactive transaction bound at the time the region was created.
 Since we limit the plugin prune upper bound using <i>(t1, inactive transaction bound)</i>,
 there should be no invalid transactions smaller than the plugin prune upper bound with writes in any
 transactional region of this HBase instance.

 <p/>
 Note: If your tables uses a transactional coprocessor other than TransactionProcessor,
 then you may need to write a new plugin to compute prune upper bound for those tables.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected org.apache.hadoop.conf.Configuration</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#conf">conf</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected HConnection</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#connection">connection</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../org/apache/tephra/hbase/txprune/DataJanitorState.html" title="class in org.apache.tephra.hbase.txprune">DataJanitorState</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#dataJanitorState">dataJanitorState</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected org.apache.hadoop.hbase.client.HBaseAdmin</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#hBaseAdmin">hBaseAdmin</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static org.slf4j.Logger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#LOG">LOG</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#HBaseTransactionPruningPlugin--">HBaseTransactionPruningPlugin</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#createPruneTable-org.apache.hadoop.hbase.TableName-">createPruneTable</a></span>(org.apache.hadoop.hbase.TableName&nbsp;stateTable)</code>
<div class="block">Create the prune state table given the <code>TableName</code> if the table doesn't exist already.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#destroy--">destroy</a></span>()</code>
<div class="block">Called once during the shutdown of the Transaction Service.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#fetchPruneUpperBound-long-long-">fetchPruneUpperBound</a></span>(long&nbsp;time,
                    long&nbsp;inactiveTransactionBound)</code>
<div class="block">Determines prune upper bound for the data store as mentioned above.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/7/docs/api/java/util/SortedSet.html?is-external=true" title="class or interface in java.util">SortedSet</a>&lt;byte[]&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#getTransactionalRegions--">getTransactionalRegions</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#initialize-org.apache.hadoop.conf.Configuration-">initialize</a></span>(org.apache.hadoop.conf.Configuration&nbsp;conf)</code>
<div class="block">Called once when the Transaction Service starts up.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#isTransactionalTable-org.apache.hadoop.hbase.HTableDescriptor-">isTransactionalTable</a></span>(org.apache.hadoop.hbase.HTableDescriptor&nbsp;tableDescriptor)</code>
<div class="block">Returns whether the table is a transactional table.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html#pruneComplete-long-long-">pruneComplete</a></span>(long&nbsp;time,
             long&nbsp;maxPrunedInvalid)</code>
<div class="block">After invalid list has been pruned, this cleans up state information that is no longer required.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="LOG">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOG</h4>
<pre>public static final&nbsp;org.slf4j.Logger LOG</pre>
</li>
</ul>
<a name="conf">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>conf</h4>
<pre>protected&nbsp;org.apache.hadoop.conf.Configuration conf</pre>
</li>
</ul>
<a name="hBaseAdmin">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hBaseAdmin</h4>
<pre>protected&nbsp;org.apache.hadoop.hbase.client.HBaseAdmin hBaseAdmin</pre>
</li>
</ul>
<a name="connection">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connection</h4>
<pre>protected&nbsp;HConnection connection</pre>
</li>
</ul>
<a name="dataJanitorState">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>dataJanitorState</h4>
<pre>protected&nbsp;<a href="../../../../../org/apache/tephra/hbase/txprune/DataJanitorState.html" title="class in org.apache.tephra.hbase.txprune">DataJanitorState</a> dataJanitorState</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="HBaseTransactionPruningPlugin--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>HBaseTransactionPruningPlugin</h4>
<pre>public&nbsp;HBaseTransactionPruningPlugin()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="initialize-org.apache.hadoop.conf.Configuration-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialize</h4>
<pre>public&nbsp;void&nbsp;initialize(org.apache.hadoop.conf.Configuration&nbsp;conf)
                throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html#initialize-org.apache.hadoop.conf.Configuration-">TransactionPruningPlugin</a></code></span></div>
<div class="block">Called once when the Transaction Service starts up.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html#initialize-org.apache.hadoop.conf.Configuration-">initialize</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html" title="interface in org.apache.tephra.txprune">TransactionPruningPlugin</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>conf</code> - configuration for the plugin</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="fetchPruneUpperBound-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fetchPruneUpperBound</h4>
<pre>public&nbsp;long&nbsp;fetchPruneUpperBound(long&nbsp;time,
                                 long&nbsp;inactiveTransactionBound)
                          throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Determines prune upper bound for the data store as mentioned above.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html#fetchPruneUpperBound-long-long-">fetchPruneUpperBound</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html" title="interface in org.apache.tephra.txprune">TransactionPruningPlugin</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>time</code> - start time of this prune iteration in milliseconds</dd>
<dd><code>inactiveTransactionBound</code> - the largest invalid transaction that can be possibly removed
                                 from the invalid list for the given time. This is an upper bound determined
                                 by the Transaction Service, based on its knowledge of in-progress and invalid
                                 transactions that may still have active processes and therefore future writes.
                                 The plugin will typically return a reduced upper bound based on the state of
                                 the invalid transaction data clean up in the data store.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>prune upper bound for the data store</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="pruneComplete-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pruneComplete</h4>
<pre>public&nbsp;void&nbsp;pruneComplete(long&nbsp;time,
                          long&nbsp;maxPrunedInvalid)
                   throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">After invalid list has been pruned, this cleans up state information that is no longer required.
 This includes -
 <ul>
   <li>
     <i>(region, prune upper bound)</i> - prune upper bound for regions that are older
     than maxPrunedInvalid
   </li>
   <li>
     <i>(t, set of regions) - Regions set that were recorded on or before the start time
     of maxPrunedInvalid
   </li>
   <li>
     (t, inactive transaction bound) - Smallest not in-progress transaction without any writes in new regions
     information recorded on or before the start time of maxPrunedInvalid
   </li>
 </ul></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html#pruneComplete-long-long-">pruneComplete</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html" title="interface in org.apache.tephra.txprune">TransactionPruningPlugin</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>time</code> - start time of this prune iteration in milliseconds (same value as passed to
             <a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html#fetchPruneUpperBound-long-long-"><code>TransactionPruningPlugin.fetchPruneUpperBound(long, long)</code></a> in the same run)</dd>
<dd><code>maxPrunedInvalid</code> - the largest invalid transaction that was removed from the invalid list</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="destroy--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>destroy</h4>
<pre>public&nbsp;void&nbsp;destroy()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html#destroy--">TransactionPruningPlugin</a></code></span></div>
<div class="block">Called once during the shutdown of the Transaction Service.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html#destroy--">destroy</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/apache/tephra/txprune/TransactionPruningPlugin.html" title="interface in org.apache.tephra.txprune">TransactionPruningPlugin</a></code></dd>
</dl>
</li>
</ul>
<a name="createPruneTable-org.apache.hadoop.hbase.TableName-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createPruneTable</h4>
<pre>protected&nbsp;void&nbsp;createPruneTable(org.apache.hadoop.hbase.TableName&nbsp;stateTable)
                         throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Create the prune state table given the <code>TableName</code> if the table doesn't exist already.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>stateTable</code> - prune state table name</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="isTransactionalTable-org.apache.hadoop.hbase.HTableDescriptor-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isTransactionalTable</h4>
<pre>protected&nbsp;boolean&nbsp;isTransactionalTable(org.apache.hadoop.hbase.HTableDescriptor&nbsp;tableDescriptor)</pre>
<div class="block">Returns whether the table is a transactional table. By default, it is a table is identified as a transactional
 table if it has a the coprocessor <a href="../../../../../org/apache/tephra/hbase/coprocessor/TransactionProcessor.html" title="class in org.apache.tephra.hbase.coprocessor"><code>TransactionProcessor</code></a> attached to it. Should be overriden if the users
 attach a different coprocessor.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tableDescriptor</code> - <code>HTableDescriptor</code> of the table</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the table is transactional</dd>
</dl>
</li>
</ul>
<a name="getTransactionalRegions--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getTransactionalRegions</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/SortedSet.html?is-external=true" title="class or interface in java.util">SortedSet</a>&lt;byte[]&gt;&nbsp;getTransactionalRegions()
                                             throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HBaseTransactionPruningPlugin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/tephra/hbase/txprune/DataJanitorState.TableSupplier.html" title="interface in org.apache.tephra.hbase.txprune"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/tephra/hbase/txprune/InvalidListPruningDebugTool.html" title="class in org.apache.tephra.hbase.txprune"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/tephra/hbase/txprune/HBaseTransactionPruningPlugin.html" target="_top">Frames</a></li>
<li><a href="HBaseTransactionPruningPlugin.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2018 <a href="http://www.apache.org">The Apache Software Foundation</a>. All rights reserved.</small></p>
</body>
</html>
